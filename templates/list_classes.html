{% include 'partials/header.html' %}
{% include 'partials/navbar.html' %}

<div class="container mt-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h3 class="mb-0">๐ ุฅุฏุงุฑุฉ ุงูุตููู ูุงูุดุนุจ</h3>
    <a href="{{ url_for('add_class') }}" class="btn btn-success">โ ุฅุถุงูุฉ ุตู ุฌุฏูุฏ</a>
  </div>

  {% if classes %}
  <div class="table-responsive">
    <table class="table table-bordered table-hover align-middle text-center">
      <thead class="table-light">
        <tr>
          <th>ุงูุตู</th>
          <th>ุงูุดุนุจุฉ</th>
          <th>ุงููุนูู</th>
          <th>ุฅุฌุฑุงุกุงุช</th>
        </tr>
      </thead>
      <tbody>
        {% for c in classes %}
        <tr id="row-{{ c.id }}">
          <td>{{ c.class_name }}</td>
          <td>{{ c.section }}</td>
          <td>{{ c.teacher_name }}</td>
          <td>
            <a href="{{ url_for('edit_class', class_id=c.id) }}" class="btn btn-sm btn-warning">โ๏ธ ุชุนุฏูู</a>
            <button class="btn btn-sm btn-danger" onclick="deleteClass({{ c.id }})">๐๏ธ ุญุฐู</button>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  {% else %}
  <div class="alert alert-info text-center">โ๏ธ ูุง ููุฌุฏ ุตููู ูุถุงูุฉ ุจุนุฏ.</div>
  {% endif %}
</div>

<script>
function deleteClass(id) {
  if (!confirm("ูู ุฃูุช ูุชุฃูุฏ ูู ุงูุญุฐูุ")) return;
  fetch(`/classes/delete/${id}`, {
    method: "POST",
    headers: {"X-Requested-With": "XMLHttpRequest"}
  })
    .then(r => r.json())
    .then(data => {
      if (data.success) {
        document.getElementById(`row-${id}`).remove();
        alert("โ " + data.message);
      } else {
        alert("โ๏ธ " + data.message);
      }
    })
    .catch(() => alert("โ ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุงูุญุฐู"));
}
</script>

{% include 'partials/footer.html' %}
